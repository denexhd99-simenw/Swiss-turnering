"use strict";(()=>{var e={};e.id=173,e.ids=[173],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5395:(e,t,a)=>{a.r(t),a.d(t,{headerHooks:()=>m,originalPathname:()=>y,patchFetch:()=>g,requestAsyncStorage:()=>l,routeModule:()=>u,serverHooks:()=>w,staticGenerationAsyncStorage:()=>c,staticGenerationBailout:()=>h});var r={};a.r(r),a.d(r,{POST:()=>p});var s=a(5419),i=a(9108),n=a(9678),o=a(8093);let d="SWISS";async function p(){let e=await o._.player.findMany({orderBy:{id:"asc"}});if(e.length<4)return new Response("Minimum 4 players required",{status:400});let t=function(e){let t=[...e];for(let e=t.length-1;e>0;e--){let a=Math.floor(Math.random()*(e+1)),r=t[e];t[e]=t[a],t[a]=r}return t}(e);return await o._.$transaction(async e=>{await e.match.deleteMany(),await e.player.updateMany({data:{points:0,wins:0,losses:0}});for(let a=0;a<t.length;a+=2){let r=t[a],s=t[a+1];if(!s){await e.match.create({data:{phase:d,round:1,player1Id:r.id,player2Id:null,winnerId:r.id}}),await e.player.update({where:{id:r.id},data:{wins:{increment:1},points:{increment:3}}});continue}await e.match.create({data:{phase:d,round:1,player1Id:r.id,player2Id:s.id}})}}),Response.json({success:!0,message:"Swiss round 1 started"})}let u=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/swiss/start/route",pathname:"/api/swiss/start",filename:"route",bundlePath:"app/api/swiss/start/route"},resolvedPagePath:"C:\\Users\\25simwek\\Downloads\\pingpong-turnering\\app\\api\\swiss\\start\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:l,staticGenerationAsyncStorage:c,serverHooks:w,headerHooks:m,staticGenerationBailout:h}=u,y="/api/swiss/start/route";function g(){return(0,n.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:c})}},8093:(e,t,a)=>{a.d(t,{_:()=>s});let r=require("@prisma/client"),s=global.prisma||new r.PrismaClient},5419:(e,t,a)=>{e.exports=a(517)}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[638],()=>a(5395));module.exports=r})();