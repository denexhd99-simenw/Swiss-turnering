"use strict";(()=>{var e={};e.id=450,e.ids=[450],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7951:(e,t,a)=>{a.r(t),a.d(t,{headerHooks:()=>w,originalPathname:()=>g,patchFetch:()=>f,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>y});var r={};a.r(r),a.d(r,{DELETE:()=>d,GET:()=>u,POST:()=>p});var n=a(5419),s=a(9108),i=a(9678),o=a(8093);async function u(){let e=await o._.match.findMany({include:{player1:!0,player2:!0,winner:!0},orderBy:[{round:"asc"},{createdAt:"asc"}]});return Response.json(e)}async function p(e){let t=await e.json(),a=Number(t.player1Id),r=Number(t.player2Id),n=Number(t.round??1),s="string"==typeof t.phase?t.phase:"SWISS";if(!Number.isInteger(a)||!Number.isInteger(r))return new Response("Missing players",{status:400});if(a===r)return new Response("Player cannot play against themselves",{status:400});let i=await o._.match.create({data:{round:n,phase:s,player1Id:a,player2Id:r}});return Response.json(i)}async function d(e){let{matchId:t}=await e.json(),a=Number(t);if(!Number.isInteger(a))return new Response("Missing matchId",{status:400});let r=await o._.match.findUnique({where:{id:a}});if(!r)return new Response("Match not found",{status:404});if(r.winnerId){let e=r.player1Id===r.winnerId?r.player2Id:r.player1Id;await o._.player.update({where:{id:r.winnerId},data:{points:{decrement:3},wins:{decrement:1}}}),e&&await o._.player.update({where:{id:e},data:{losses:{decrement:1}}})}return await o._.match.delete({where:{id:a}}),Response.json({success:!0})}let c=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/matches/route",pathname:"/api/matches",filename:"route",bundlePath:"app/api/matches/route"},resolvedPagePath:"C:\\Users\\25simwek\\Downloads\\pingpong-turnering\\app\\api\\matches\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:h,headerHooks:w,staticGenerationBailout:y}=c,g="/api/matches/route";function f(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}},8093:(e,t,a)=>{a.d(t,{_:()=>n});let r=require("@prisma/client"),n=global.prisma||new r.PrismaClient},5419:(e,t,a)=>{e.exports=a(517)}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[638],()=>a(7951));module.exports=r})();