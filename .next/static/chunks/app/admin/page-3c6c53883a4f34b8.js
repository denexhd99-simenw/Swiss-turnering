(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{46:function(e,r,d){Promise.resolve().then(d.bind(d,9789))},9789:function(e,r,d){"use strict";d.r(r),d.d(r,{default:function(){return t}});var l=d(3827),a=d(4090),n=d(4464);function t(){let[e,r]=(0,a.useState)(!1),[d,t]=(0,a.useState)(""),[s,i]=(0,a.useState)([]),[o,c]=(0,a.useState)([]),[m,x]=(0,a.useState)(null),[u,p]=(0,a.useState)(!1),[b,h]=(0,a.useState)(null);async function v(){let[e,r]=await Promise.all([fetch("/api/players").then(e=>e.json()),fetch("/api/matches").then(e=>e.json())]);i(e),c(r)}async function g(){await fetch("/api/swiss/start",{method:"POST"}),await v()}async function y(e,r){x(e),c(d=>d.map(d=>d.id===e?{...d,winnerId:r}:d)),await fetch("/api/matches/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({winnerId:r})}),await v(),x(null)}async function f(){p(!0),await fetch("/api/knockout/start",{method:"POST"}),await v(),p(!1)}(0,a.useEffect)(()=>{if(!e)return;v();let r=setInterval(v,3e3);return()=>clearInterval(r)},[e]);let N=(0,a.useMemo)(()=>o.some(e=>"KNOCKOUT"===e.phase),[o]),j=(0,a.useMemo)(()=>o.filter(e=>"SWISS"===e.phase&&e.player2&&!e.winnerId),[o]),w=(0,a.useMemo)(()=>s.filter(e=>e.wins>=3),[s]),k=(0,a.useMemo)(()=>!N&&0===j.length&&w.length>=2,[N,j.length,w.length]),S=(0,a.useMemo)(()=>{let e=o.filter(e=>"SWISS"===e.phase&&e.player2&&!e.winnerId),r=o.filter(e=>"KNOCKOUT"===e.phase&&e.player2&&!e.winnerId),d=e.length>0?e:r,l=d.map(e=>e.round),a=l.length?Math.min(...l):null;return{currentRound:a,phase:e.length>0?"SWISS":r.length>0?"KNOCKOUT":null,matches:a?d.filter(e=>e.round===a):[]}},[o]);return e?(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsxs)("div",{className:"rounded-2xl border border-cyan-500/40 bg-gradient-to-r from-slate-950 via-[#0a2047] to-slate-950 p-6",children:[(0,l.jsx)("h1",{className:"text-4xl font-black tracking-wide text-cyan-200",children:"Admin Swiss Kontroll"}),(0,l.jsx)("p",{className:"mt-2 text-slate-300",children:"Klikk direkte paa vinnaren i kvar kamp."}),(0,l.jsx)("button",{onClick:g,className:"mt-5 rounded-lg bg-emerald-600 px-6 py-2 font-bold text-white hover:bg-emerald-500",children:"Start turnering"}),k&&(0,l.jsx)("button",{onClick:f,disabled:u,className:"ml-3 mt-5 rounded-lg bg-amber-500 px-6 py-2 font-bold text-slate-950 hover:bg-amber-400 disabled:opacity-60",children:"Start vinn-eller-forsvinn"})]}),(0,l.jsxs)("div",{className:"rounded-2xl border border-cyan-500/30 bg-slate-950/60 p-4",children:[(0,l.jsx)("label",{className:"mb-2 block text-sm font-semibold text-cyan-300",children:"Marker spelar"}),(0,l.jsxs)("select",{value:null!=b?b:"",onChange:e=>h(e.target.value?Number(e.target.value):null),className:"w-full rounded-lg border border-cyan-500/40 bg-[#07162f] px-4 py-2 text-white md:w-[340px]",children:[(0,l.jsx)("option",{value:"",children:"Vis alle"}),s.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,l.jsx)(n.Z,{players:s,matches:o,selectedPlayerId:b}),(0,l.jsxs)("div",{className:"rounded-2xl border border-amber-500/40 bg-slate-950/75 p-6",children:[(0,l.jsx)("h2",{className:"mb-1 text-2xl font-black tracking-wide text-amber-300",children:"Aktive kampar"}),(0,l.jsx)("p",{className:"mb-5 text-slate-400",children:S.currentRound?"".concat("SWISS"===S.phase?"Swiss":"Knockout"," runde ").concat(S.currentRound):N?"Knockout ferdig, vinnar staar igjen.":"Ingen opne kampar akkurat no"}),(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[S.matches.map(e=>{var r,d,a,n,t,s;return(0,l.jsxs)("div",{className:"rounded-xl border border-amber-400/50 bg-[#0c1b33] p-4",children:[(0,l.jsxs)("div",{className:"mb-3 text-xs font-bold text-amber-300",children:["Kamp #",e.id]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,l.jsx)("button",{disabled:m===e.id||!e.player1,onClick:()=>e.player1&&y(e.id,e.player1.id),className:"rounded-lg px-3 py-3 text-left font-semibold transition ".concat(e.winnerId===(null===(r=e.player1)||void 0===r?void 0:r.id)?"bg-emerald-600 text-white":"bg-slate-800 text-slate-100 hover:bg-emerald-700/70"),children:null!==(t=null===(d=e.player1)||void 0===d?void 0:d.name)&&void 0!==t?t:"TBA"}),(0,l.jsx)("button",{disabled:m===e.id||!e.player2,onClick:()=>e.player2&&y(e.id,e.player2.id),className:"rounded-lg px-3 py-3 text-left font-semibold transition ".concat(e.winnerId===(null===(a=e.player2)||void 0===a?void 0:a.id)?"bg-emerald-600 text-white":"bg-slate-800 text-slate-100 hover:bg-emerald-700/70"),children:null!==(s=null===(n=e.player2)||void 0===n?void 0:n.name)&&void 0!==s?s:"TBA"})]})]},e.id)}),0===S.matches.length&&(0,l.jsx)("div",{className:"rounded-xl border border-dashed border-slate-700 p-5 text-sm text-slate-400",children:"Ventar paa neste runde eller turnering er ferdig."})]})]})]}):(0,l.jsx)("div",{className:"flex min-h-[70vh] items-center justify-center",children:(0,l.jsxs)("div",{className:"w-[420px] rounded-2xl border border-cyan-500/30 bg-slate-950/85 p-8",children:[(0,l.jsx)("h2",{className:"mb-5 text-2xl font-black tracking-wide text-cyan-200",children:"Admin Login"}),(0,l.jsx)("input",{type:"password",placeholder:"Passord",value:d,onChange:e=>t(e.target.value),className:"mb-4 w-full rounded-lg border border-cyan-500/40 bg-[#07162f] px-4 py-3 text-white"}),(0,l.jsx)("button",{onClick:()=>r("admin"===d),className:"w-full rounded-lg bg-cyan-600 py-3 font-bold text-white hover:bg-cyan-500",children:"Logg inn"})]})})}},4464:function(e,r,d){"use strict";d.d(r,{Z:function(){return o}});var l=d(3827);let a=[{title:"Start",rounds:[1]},{title:"Runde 2",rounds:[2]},{title:"Runde 3",rounds:[3]},{title:"Runde 4",rounds:[4]},{title:"Siste Sjans",rounds:[5]}],n=["3-0","3-1","3-2"],t=["0-3","1-3","2-3"];function s(e,r,d){let l=["rounded-md px-2 py-1 text-sm"];return d?l.push("bg-emerald-600/35 text-emerald-100"):l.push("bg-slate-900/90 text-slate-100"),r&&e===r&&l.push("ring-2 ring-cyan-300 shadow-[0_0_0_1px_rgba(103,232,249,.45)]"),l.join(" ")}function i(e,r){var d,l;let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"cyan";return r&&((null===(d=e.player1)||void 0===d?void 0:d.id)===r||(null===(l=e.player2)||void 0===l?void 0:l.id)===r)?"amber"===a?"rounded-xl border border-cyan-300 bg-[#102445] p-3 ring-2 ring-cyan-300 shadow-[0_0_0_1px_rgba(103,232,249,.45)]":"rounded-xl border border-cyan-300 bg-[#0d2243] p-3 ring-2 ring-cyan-300 shadow-[0_0_0_1px_rgba(103,232,249,.45)]":"amber"===a?"rounded-xl border border-amber-400/45 bg-[#0c1b33] p-3 shadow-[0_0_0_1px_rgba(251,191,36,.15)]":"rounded-xl border border-cyan-500/50 bg-[#07162f] p-3 shadow-[0_0_0_1px_rgba(34,211,238,.15)]"}function o(e){var r,d,o;let{players:c,matches:m,selectedPlayerId:x}=e,u=function(e){let r={};for(let d of e){let e="".concat(d.wins,"-").concat(d.losses);r[e]||(r[e]=[]),r[e].push(d)}return r}(c),p=m.filter(e=>"SWISS"===e.phase),b=m.filter(e=>"KNOCKOUT"===e.phase),h=b.length>0,v=Array.from(new Set(b.map(e=>e.round))).sort((e,r)=>e-r),g=v.length?b.find(e=>e.round===v[v.length-1]):null,y=g&&g.winnerId?g.winnerId:g&&null===g.player2&&null!==(d=null===(r=g.player1)||void 0===r?void 0:r.id)&&void 0!==d?d:null,f=y?c.find(e=>e.id===y):null;return(0,l.jsx)("div",{className:"space-y-6",children:(0,l.jsx)("div",{className:"overflow-x-auto",children:h?(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"rounded-xl border border-amber-400/45 bg-[#0b1730] px-4 py-3 text-sm font-bold text-amber-300",children:"VINN ELLER FORSVINN"}),(0,l.jsxs)("div",{className:"grid min-w-[1200px] grid-cols-5 gap-4",children:[v.map(e=>{let r=b.filter(r=>r.round===e).sort((e,r)=>e.id-r.id);return(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"rounded-lg border border-amber-400/45 bg-slate-950/90 px-3 py-2 text-center text-sm font-bold text-amber-200",children:["Runde ",e]}),r.map(e=>{var r,d,a,n,t,o,c,m;return(0,l.jsxs)("div",{className:i(e,x,"amber"),children:[(0,l.jsxs)("div",{className:"mb-2 text-[11px] font-bold tracking-wider text-amber-300",children:["Kamp #",e.id]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("div",{className:s(null===(r=e.player1)||void 0===r?void 0:r.id,x,e.winnerId===(null===(d=e.player1)||void 0===d?void 0:d.id)),children:null!==(c=null===(a=e.player1)||void 0===a?void 0:a.name)&&void 0!==c?c:"TBA"}),(0,l.jsx)("div",{className:"text-center text-[10px] font-bold text-slate-500",children:"VS"}),(0,l.jsx)("div",{className:s(null===(n=e.player2)||void 0===n?void 0:n.id,x,e.winnerId===(null===(t=e.player2)||void 0===t?void 0:t.id)),children:null!==(m=null===(o=e.player2)||void 0===o?void 0:o.name)&&void 0!==m?m:"TBA"})]})]},e.id)})]},e)}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("div",{className:"rounded-lg border border-emerald-400/60 bg-emerald-900/30 px-3 py-2 text-center text-sm font-bold text-emerald-300",children:"Vinnar"}),(0,l.jsxs)("div",{className:"rounded-xl border border-emerald-400/60 bg-emerald-950/40 p-3",children:[(0,l.jsx)("div",{className:"mb-2 text-xs font-bold tracking-wider text-emerald-300",children:"Champion"}),(0,l.jsx)("div",{className:"rounded-md bg-emerald-600/30 px-2 py-2 text-sm text-emerald-100",children:null!==(o=null==f?void 0:f.name)&&void 0!==o?o:"Ikkje avgjort enno"})]})]})]})]}):(0,l.jsxs)("div",{className:"grid min-w-[1200px] grid-cols-7 gap-4",children:[a.map(e=>{let r=p.filter(r=>e.rounds.includes(r.round)).sort((e,r)=>e.id-r.id);return(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("div",{className:"rounded-lg border border-cyan-500/40 bg-slate-950/90 px-3 py-2 text-center text-sm font-bold text-cyan-200",children:e.title}),r.map(e=>{var r,d,a,n,t,o,c,m;return(0,l.jsxs)("div",{className:i(e,x,"cyan"),children:[(0,l.jsxs)("div",{className:"mb-2 text-[11px] font-bold tracking-wider text-cyan-300",children:["Kamp #",e.id]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("div",{className:s(null===(r=e.player1)||void 0===r?void 0:r.id,x,e.winnerId===(null===(d=e.player1)||void 0===d?void 0:d.id)),children:null!==(c=null===(a=e.player1)||void 0===a?void 0:a.name)&&void 0!==c?c:"TBA"}),(0,l.jsx)("div",{className:"text-center text-[10px] font-bold text-slate-500",children:"VS"}),(0,l.jsx)("div",{className:s(null===(n=e.player2)||void 0===n?void 0:n.id,x,e.winnerId===(null===(t=e.player2)||void 0===t?void 0:t.id)),children:null!==(m=null===(o=e.player2)||void 0===o?void 0:o.name)&&void 0!==m?m:"TBA"})]})]},e.id)}),0===r.length&&(0,l.jsx)("div",{className:"rounded-xl border border-dashed border-slate-700 bg-[#07162f] p-3 text-xs text-slate-500",children:"Ingen kampar"})]},e.title)}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("div",{className:"rounded-lg border border-emerald-400/60 bg-emerald-900/30 px-3 py-2 text-center text-sm font-bold text-emerald-300",children:"Vidare"}),n.map(e=>{var r,d;return(0,l.jsxs)("div",{className:"rounded-xl border border-emerald-400/60 bg-emerald-950/40 p-3",children:[(0,l.jsx)("div",{className:"mb-2 text-xs font-bold tracking-wider text-emerald-300",children:e}),(0,l.jsxs)("div",{className:"space-y-2",children:[(null!==(r=u[e])&&void 0!==r?r:[]).map(e=>(0,l.jsx)("div",{className:"rounded-md px-2 py-1 text-sm ".concat(s(e.id,x,!1)),children:e.name},e.id)),0===(null!==(d=u[e])&&void 0!==d?d:[]).length&&(0,l.jsx)("div",{className:"rounded-md border border-dashed border-emerald-800 px-2 py-2 text-xs text-emerald-700",children:"Ingen"})]})]},e)})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("div",{className:"rounded-lg border border-rose-400/60 bg-rose-900/30 px-3 py-2 text-center text-sm font-bold text-rose-300",children:"Ute"}),t.map(e=>{var r,d;return(0,l.jsxs)("div",{className:"rounded-xl border border-rose-400/60 bg-rose-950/40 p-3",children:[(0,l.jsx)("div",{className:"mb-2 text-xs font-bold tracking-wider text-rose-300",children:e}),(0,l.jsxs)("div",{className:"space-y-2",children:[(null!==(r=u[e])&&void 0!==r?r:[]).map(e=>(0,l.jsx)("div",{className:"rounded-md px-2 py-1 text-sm ".concat(s(e.id,x,!1)),children:e.name},e.id)),0===(null!==(d=u[e])&&void 0!==d?d:[]).length&&(0,l.jsx)("div",{className:"rounded-md border border-dashed border-rose-800 px-2 py-2 text-xs text-rose-700",children:"Ingen"})]})]},e)})]})]})})})}}},function(e){e.O(0,[971,69,744],function(){return e(e.s=46)}),_N_E=e.O()}]);